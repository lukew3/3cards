(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[396],{8660:function(e,t,r){var n,i=r(3454);!function(e){!function(t){var n="object"===typeof r.g?r.g:"object"===typeof self?self:"object"===typeof this?this:Function("return this;")(),o=s(e);function s(e,t){return function(r,n){"function"!==typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}"undefined"===typeof n.Reflect?n.Reflect=e:o=s(n.Reflect,o),function(e){var t=Object.prototype.hasOwnProperty,r="function"===typeof Symbol,n=r&&"undefined"!==typeof Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&"undefined"!==typeof Symbol.iterator?Symbol.iterator:"@@iterator",s="function"===typeof Object.create,u={__proto__:[]}instanceof Array,a=!s&&!u,f={create:s?function(){return ie(Object.create(null))}:u?function(){return ie({__proto__:null})}:function(){return ie({})},has:a?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:a?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),l="object"===typeof i&&i.env&&"true"===i.env.REFLECT_METADATA_USE_MAP_POLYFILL,p=l||"function"!==typeof Map||"function"!==typeof Map.prototype.entries?te():Map,h=l||"function"!==typeof Set||"function"!==typeof Set.prototype.entries?re():Set,d=new(l||"function"!==typeof WeakMap?ne():WeakMap);function y(e,t,r,n){if(q(r)){if(!V(e))throw new TypeError;if(!Y(t))throw new TypeError;return A(e,t)}if(!V(e))throw new TypeError;if(!K(t))throw new TypeError;if(!K(n)&&!q(n)&&!L(n))throw new TypeError;return L(n)&&(n=void 0),I(e,t,r=F(r),n)}function v(e,t){function r(r,n){if(!K(r))throw new TypeError;if(!q(n)&&!H(n))throw new TypeError;M(e,t,r,n)}return r}function _(e,t,r,n){if(!K(r))throw new TypeError;return q(n)||(n=F(n)),M(e,t,r,n)}function m(e,t,r){if(!K(t))throw new TypeError;return q(r)||(r=F(r)),j(e,t,r)}function g(e,t,r){if(!K(t))throw new TypeError;return q(r)||(r=F(r)),T(e,t,r)}function w(e,t,r){if(!K(t))throw new TypeError;return q(r)||(r=F(r)),N(e,t,r)}function b(e,t,r){if(!K(t))throw new TypeError;return q(r)||(r=F(r)),x(e,t,r)}function P(e,t){if(!K(e))throw new TypeError;return q(t)||(t=F(t)),C(e,t)}function E(e,t){if(!K(e))throw new TypeError;return q(t)||(t=F(t)),S(e,t)}function k(e,t,r){if(!K(t))throw new TypeError;q(r)||(r=F(r));var n=O(t,r,!1);if(q(n))return!1;if(!n.delete(e))return!1;if(n.size>0)return!0;var i=d.get(t);return i.delete(r),i.size>0||d.delete(t),!0}function A(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!q(n)&&!L(n)){if(!Y(n))throw new TypeError;t=n}}return t}function I(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!q(o)&&!L(o)){if(!K(o))throw new TypeError;n=o}}return n}function O(e,t,r){var n=d.get(e);if(q(n)){if(!r)return;n=new p,d.set(e,n)}var i=n.get(t);if(q(i)){if(!r)return;i=new p,n.set(t,i)}return i}function j(e,t,r){if(T(e,t,r))return!0;var n=ee(t);return!L(n)&&j(e,n,r)}function T(e,t,r){var n=O(t,r,!1);return!q(n)&&z(n.has(e))}function N(e,t,r){if(T(e,t,r))return x(e,t,r);var n=ee(t);return L(n)?void 0:N(e,n,r)}function x(e,t,r){var n=O(t,r,!1);if(!q(n))return n.get(e)}function M(e,t,r,n){O(r,n,!0).set(e,t)}function C(e,t){var r=S(e,t),n=ee(e);if(null===n)return r;var i=C(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new h,s=[],u=0,a=r;u<a.length;u++){var f=a[u];o.has(f)||(o.add(f),s.push(f))}for(var c=0,l=i;c<l.length;c++){f=l[c];o.has(f)||(o.add(f),s.push(f))}return s}function S(e,t){var r=[],n=O(e,t,!1);if(q(n))return r;for(var i=Z(n.keys()),o=0;;){var s=X(i);if(!s)return r.length=o,r;var u=Q(s);try{r[o]=u}catch(a){try{$(i)}finally{throw a}}o++}}function R(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function q(e){return void 0===e}function L(e){return null===e}function U(e){return"symbol"===typeof e}function K(e){return"object"===typeof e?null!==e:"function"===typeof e}function W(e,t){switch(R(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=J(e,n);if(void 0!==i){var o=i.call(e,r);if(K(o))throw new TypeError;return o}return D(e,"default"===r?"number":r)}function D(e,t){if("string"===t){var r=e.toString;if(B(r))if(!K(i=r.call(e)))return i;if(B(n=e.valueOf))if(!K(i=n.call(e)))return i}else{var n;if(B(n=e.valueOf))if(!K(i=n.call(e)))return i;var i,o=e.toString;if(B(o))if(!K(i=o.call(e)))return i}throw new TypeError}function z(e){return!!e}function G(e){return""+e}function F(e){var t=W(e,3);return U(t)?t:G(t)}function V(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function B(e){return"function"===typeof e}function Y(e){return"function"===typeof e}function H(e){switch(R(e)){case 3:case 4:return!0;default:return!1}}function J(e,t){var r=e[t];if(void 0!==r&&null!==r){if(!B(r))throw new TypeError;return r}}function Z(e){var t=J(e,o);if(!B(t))throw new TypeError;var r=t.call(e);if(!K(r))throw new TypeError;return r}function Q(e){return e.value}function X(e){var t=e.next();return!t.done&&t}function $(e){var t=e.return;t&&t.call(e)}function ee(e){var t=Object.getPrototypeOf(e);if("function"!==typeof e||e===c)return t;if(t!==c)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!==typeof i||i===e?t:i}function te(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,i)},t.prototype.entries=function(){return new r(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function i(e,t){return t}function s(e,t){return[e,t]}}function re(){return function(){function e(){this._map=new p}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}()}function ne(){var e=16,r=f.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&f.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?f.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+a()}while(f.has(r,e));return r[e]=!0,e}function o(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:f.create()})}return e[n]}function s(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function u(e){return"function"===typeof Uint8Array?"undefined"!==typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!==typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function a(){var t=u(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",y),e("metadata",v),e("defineMetadata",_),e("hasMetadata",m),e("hasOwnMetadata",g),e("getMetadata",w),e("getOwnMetadata",b),e("getMetadataKeys",P),e("getOwnMetadataKeys",E),e("deleteMetadata",k)}(o)}()}(n||(n={}))},1291:function(e,t,r){let n;function i(e){if("function"!==typeof e)throw new Error("This module should not be used in runtime. Instead, use a transformer during compilation.")}const o=Symbol("assertions");function s(e,t,n){if(void 0===e)return"validation error";const i=function(e,t){let r=t;for(const n of e.slice(1))r=r[n.startsWith("[")?parseInt(n.replace("[","").replace("]","")):n];return r}(t,n);try{return e+", found: "+r(9539).inspect(i)}catch(o){}try{return e+", found: "+JSON.stringify(i)}catch(o){}return e}class u extends Error{constructor(e,t){super(s(e.message,e.path,t)),this.name="TypeGuardError",this.path=e.path,this.reason=e.reason,this.input=t}}function a(e,t=n){i(t);return null===t(e)}function f(e,t=n){i(t);const r=t(e);if(null===r)return e;throw new u(r,e)}function c(e=n){return i(e),t=>a(t,e)}function l(e=n){return i(e),t=>f(t,e)}e.exports={is:a,assertType:f,createIs:c,createAssertType:l,equals:a,createEquals:c,assertEquals:f,createAssertEquals:l,AssertType:function(e,t={}){return r(8660),function(r,n,i){const s=Reflect.getOwnMetadata(o,r,n)||[];Reflect.getOwnMetadata("design:returntype",r,n)===Promise?s[i]={assertion:e,options:Object.assign({async:!0},t)}:s[i]={assertion:e,options:t},Reflect.defineMetadata(o,s,r,n)}},ValidateClass:function(e=u){return r(8660),function(t){for(const r of Object.getOwnPropertyNames(t.prototype)){const n=Reflect.getOwnMetadata(o,t.prototype,r);if(n){const i=t.prototype[r];t.prototype[r]=function(...t){for(let r=0;r<n.length;r++){if(!n[r])continue;const i=n[r].assertion(t[r]);if(null!==i){const o=new e(i,t[r]);if(n[r].options.async)return Promise.reject(o);throw o}}return i.apply(this,t)}}}}},TypeGuardError:u,setDefaultGetErrorObject:function(e){n=e}}},9396:function(e,t,r){"use strict";r.d(t,{Z:function(){return _}});var n=r(7825),i=r(1291),o=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{a(n.next(e))}catch(t){o(t)}}function u(e){try{a(n.throw(e))}catch(t){o(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))},s=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};class u{constructor(){var e;this.mittInstance={all:e=e||new Map,on:function(t,r){var n=e.get(t);n?n.push(r):e.set(t,[r])},off:function(t,r){var n=e.get(t);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var n=e.get(t);n&&n.slice().map((function(e){e(r)})),(n=e.get("*"))&&n.slice().map((function(e){e(t,r)}))}}}emit(e,t){this.mittInstance.emit(e,t)}on(e,t){this.mittInstance.on(e,t)}off(e,t){this.mittInstance.off(e,t)}once(e,t){return new Promise((r=>{const n=i=>{this.off(e,n),r(i),t&&t(i)};this.on(e,n)}))}}class a{constructor(){this._promiseController=[]}newMessagePromise(e,t){e.id=this._promiseController.length;const r=new Promise(((e,t)=>this._promiseController.push({resolve:e,reject:t})));return(null===t||void 0===t?void 0:t.timeout)&&setTimeout((()=>this._promiseController[e.id].reject("timeout")),t.timeout),r}processResponse(e){const{id:t,result:r,error:n}=e;if(null!=t){if("number"!==typeof t&&"string"!==typeof t)throw"error";if("string"===typeof t&&isNaN(parseInt(t)))throw"error";if(!this._promiseController[+t])throw"received result to nonexistent request";return null!=n?this._promiseController[+t].reject(n):this._promiseController[+t].resolve(r),!0}}}class f extends u{constructor(e,t){super(),this._iframe={},this._showIframe=!1,this._popup={},this._usePopup=!0,this._requirePopup=!1,this._keepPopup=!1,this._promiseController=new a,this._pending=[],this.listener=e=>{var t,r,n,o,s,u;if(e.source!==this._popup.window&&e.source!==(null===(t=this._iframe)||void 0===t?void 0:t.window))return;if(e.origin!==(null===(r=this._url)||void 0===r?void 0:r.origin))return;if("object"!==typeof e.data)return;const{method:a,params:f,id:c,result:l,error:p,session:h}=e.data;if(console.info("WalletConnector:"+(e.source===this._popup.window?"popup":"iframe"),e.data),null!=c&&(this._pending=this._pending.filter((e=>e!=c))),this._promiseController.processResponse(e.data))return;if("string"!==typeof a)return;if("ready"===a)return e.source===this._popup.window&&(null===(o=(n=this._popup).resolve)||void 0===o||o.call(n)),void(e.source===this._iframe.window&&(null===(u=(s=this._iframe).resolve)||void 0===u||u.call(s)));if("change"===a)return;if("showIframe"===a){if("boolean"!==typeof f)return;this.showIframe=f}if("usePopup"===a){if("boolean"!==typeof f)return;this.setUsePopup(f)}if("keepPopup"===a){if("boolean"!==typeof f)return;this.setRequirePopup(f)}const d={method:a,params:f,session:h};if(!(0,i.is)(d,(e=>{function t(e){return"string"!==typeof e?{}:null}function r(e){return void 0!==e?{}:null}function n(e){return"number"!==typeof e?{}:null}return function(e){if("object"!==typeof e||null===e||Array.isArray(e))return{};if(!("method"in e))return{};if(i=t(e.method))return i;if(!("params"in e))return{};if(i=(e.params,null))return i;if("session"in e){var i=function(e){var i=[r,t,n];for(const t of i)if(!t(e))return null;return{}}(e.session);if(i)return i}return null}(e)})))return console.warn("dropped");this.emit("message",d)},this._iframeParentNode=null===t||void 0===t?void 0:t.iframeParentNode,this._url=e;const r={origin:window.location.origin,session:Math.random().toString().slice(2)};(null===t||void 0===t?void 0:t.name)&&(r.name=t.name),(null===t||void 0===t?void 0:t.logo)&&(r.logo=t.logo),this._url.hash=new URLSearchParams(r).toString(),window.addEventListener("message",this.listener)}get url(){var e;return null===(e=this._url)||void 0===e?void 0:e.origin}get showIframe(){return this._showIframe}set showIframe(e){e!==this._showIframe&&(this._showIframe=e,this.deliverMessage({method:"showIframe",params:e}),this.emit("builtin",{showIframe:e}),this._iframeNode&&(this._iframeParentNode||(this._iframeNode.style.opacity=e?"1":"0",e?this._iframeNode.style.removeProperty("pointer-events"):this._iframeNode.style.pointerEvents="none",e?this._iframeNode.style.removeProperty("touch-action"):this._iframeNode.style.touchAction="none",this._iframeNode.style.zIndex=e?"1000000":"-1000000",this._iframeNode.style.transition=e?"opacity 0.2s ease":"opacity 0.2s ease, z-index 0s linear 0.2s")))}get usePopup(){return this._usePopup}setUsePopup(e){e!==this._usePopup&&(this._usePopup=e,this.emit("builtin",{usePopup:e}))}get requirePopup(){return this._requirePopup}setRequirePopup(e){e!==this._requirePopup&&(this._requirePopup=e,this.emit("builtin",{requirePopup:e}))}get keepPopup(){return this._keepPopup}set keepPopup(e){this._keepPopup=e,this.emit("builtin",{keepPopup:e}),e||this.closePopup(),e&&this.openPopup(!0)}destructor(e){this.closeIframe(),this.closePopup(!0),window.removeEventListener("message",this.listener)}postMessage(e,t){const r=this._promiseController.newMessagePromise(e,t).finally((()=>this.completeRequest()));return this.deliverMessage(e),r}openIframe(){if(this._iframeEl)return;this._iframeNode=document.createElement("div"),this._iframeEl=document.createElement("iframe"),this._iframeEl.src=this._url.toString(),this._iframeEl.allow="usb; camera; payment; web-share",this._iframeEl.style.border="none",this._iframeParentNode||(this._iframeEl.width="400",this._iframeEl.height="600",this._iframeEl.style.borderRadius="8px",this._iframeEl.style.maxWidth="100%",this._iframeEl.style.maxHeight="100%",this._iframeNode.style.position="fixed",this._iframeNode.style.inset="0",this._iframeNode.style.display="flex",this._iframeNode.style.alignItems="center",this._iframeNode.style.justifyContent="center",this._iframeNode.style.background="#00000088",this._iframeNode.style.opacity="0",this._iframeNode.style.pointerEvents="none",this._iframeNode.style.touchAction="none",this._iframeNode.style.zIndex="-1000000",this._iframeNode.style.transition="opacity 0.2s ease, z-index 0s linear 0.2s"),this._iframeNode.appendChild(this._iframeEl);const e=new Promise(((e,t)=>this._iframe={resolve:e,reject:t}));this._iframe.promise=e;const t=()=>{var e;this._iframeParentNode?this._iframeParentNode.appendChild(this._iframeNode):document.body.appendChild(this._iframeNode),this._iframe.window=null===(e=this._iframeEl)||void 0===e?void 0:e.contentWindow};"complete"===document.readyState||"interactive"===document.readyState?t():document.addEventListener("DOMContentLoaded",t)}closeIframe(){var e,t,r,n;null===(e=this._iframeEl)||void 0===e||e.setAttribute("src","about:blank"),null===(t=this._iframeNode)||void 0===t||t.remove(),this._iframeNode=void 0,this._iframeEl=void 0,null===(n=(r=this._iframe).reject)||void 0===n||n.call(r),this._iframe={}}openPopup(e){if(this._popup.window&&!this._popup.window.closed)return void this._popup.window.focus();if(!this.usePopup&&!e)return;window.name="parent";const t=window.open(this._url.toString(),"_blank","location,resizable,scrollbars,width=400,height=600"),r=new Promise(((e,r)=>this._popup={window:t,resolve:e,reject:r}));this._popup.promise=r;const n=setInterval((()=>{this._popup.window&&!this._popup.window.closed||(this.keepPopup&&(this.keepPopup=!1),clearInterval(n))}),200)}closePopup(e){var t,r,n;this._popup.window&&!(null===(t=this._popup.window)||void 0===t?void 0:t.closed)&&(!this.keepPopup&&!this.requirePopup||e)&&(this._popup.window.location.href="about:blank",this._popup.window.close(),null===(n=(r=this._popup).reject)||void 0===n||n.call(r),this._popup={})}completeRequest(){setTimeout((()=>{this._pending.length||(this.closePopup(),this.showIframe=!1)}),100)}deliverMessage(e,t){var r,n;if(!this._url)throw"Missing URL";console.info("WalletConnector:post",e);const i=Object.assign(Object.assign({},e),{jsonrpc:"2.0"});null!=i.id&&this._pending.push(i.id),this.openIframe(),this._iframe.promise=null===(r=this._iframe.promise)||void 0===r?void 0:r.then((()=>{var e;return null===(e=this._iframe.window)||void 0===e?void 0:e.postMessage(i,this._url.origin,(null===t||void 0===t?void 0:t.transfer)?[i]:void 0)})).catch((()=>{})),this.openPopup(),this._popup.promise=null===(n=this._popup.promise)||void 0===n?void 0:n.then((()=>{var e;return null===(e=this._popup.window)||void 0===e?void 0:e.postMessage(i,this._url.origin,(null===t||void 0===t?void 0:t.transfer)?[i]:void 0)})).catch((()=>{}))}}let c;const l=[],p={},h={};function d(){for(const e of l)for(const t in e.namespaces)p[t]&&p[t]!==e||window[t]!==e.namespaces[t]&&(h[t]=window[t],window[t]=e.namespaces[t],p[t]=e);window.clearInterval(c),l.length&&(c=setInterval((()=>d()),1e4))}var y=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{a(n.next(e))}catch(t){o(t)}}function u(e){try{a(n.throw(e))}catch(t){o(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}a((n=n.apply(e,t||[])).next())}))};class v extends u{constructor(e,t){super(),this._session=0,this._listener=e=>{const{method:t,params:r,session:n}=e;if((null==n||this._session==n)&&(n||!this._session)){if("connect"===t){if(!(0,i.is)(r,(e=>function(e){return"string"!==typeof e?{}:null}(e))))return;this.setAddress(r)}"disconnect"===t&&this.disconnectEvent(!1)}},this._appInfo=e,this._emitterPassthrough=e=>{const t=Object.entries(e)[0];this.emit(t[0],t[1])},this.on("connect",(()=>{var e;(e=this).namespaces&&(l.find((t=>t===e))||l.push(e),d())})),this.on("disconnect",(()=>function(e){if(!l.find((t=>t===e)))return d();l.splice(l.indexOf(e),1);for(const t in e.namespaces)p[t]===e&&(window[t]=h[t],delete h[t],delete p[t]);d()}(this))),t&&this.setUrl(t)}get address(){return this._address}setAddress(e){e&&e===this.address||(this._address=e,null!=e?this.emit("connect",e):this.emit("disconnect",e),this.emit("change",e))}get connected(){return null!=this._address}get url(){var e;return null===(e=this._bridge)||void 0===e?void 0:e.url}get showIframe(){var e;return(null===(e=this._bridge)||void 0===e?void 0:e.showIframe)||!1}get usePopup(){var e;return(null===(e=this._bridge)||void 0===e?void 0:e.usePopup)||!1}get requirePopup(){var e;return(null===(e=this._bridge)||void 0===e?void 0:e.requirePopup)||!1}get keepPopup(){var e;return(null===(e=this._bridge)||void 0===e?void 0:e.keepPopup)||!1}set keepPopup(e){this._bridge&&(this._bridge.keepPopup=e)}setUrl(e){var t;if(!window)return void console.error("Window context missing. If you are using a server side rendering framework, make sure that the connector is excluded. If you want to use the connector outside the browser, use the node version of the module instead");const r=this._bridge,n=function(e){return"object"===typeof e?e:(e.includes("://")||(e="https://"+e),new URL(e))}(e);if(this._url=n,(null===(t=this._bridge)||void 0===t?void 0:t.url)!==n.origin){if(this.disconnect(),v._bridges[n.origin]){this._bridge=v._bridges[n.origin].bridge;const e=v._bridges[n.origin].sessions;for(let t=0;t<=e.length;t++)if(e.indexOf(t)<0){this._session=t;break}}else this._bridge=new f(n,this._appInfo),v._bridges[n.origin]={bridge:this._bridge,sessions:[]};v._bridges[n.origin].sessions.push(this._session),this._bridge.on("message",this._listener),this._bridge.on("builtin",this._emitterPassthrough),this._bridge.showIframe!==(null===r||void 0===r?void 0:r.showIframe)&&this.emit("showIframe",this._bridge.showIframe),this._bridge.usePopup!==(null===r||void 0===r?void 0:r.usePopup)&&this.emit("usePopup",this._bridge.usePopup),this._bridge.requirePopup!==(null===r||void 0===r?void 0:r.requirePopup)&&this.emit("requirePopup",this._bridge.requirePopup),this._bridge.keepPopup!==(null===r||void 0===r?void 0:r.keepPopup)&&this.emit("keepPopup",this._bridge.keepPopup)}}connect(e){return y(this,void 0,void 0,(function*(){this._bridge||this._url&&this.setUrl(this._url);const t=new Promise(((e,t)=>{this.once("change",(r=>r?e(r):t()))})).finally((()=>{var e;return null===(e=this._bridge)||void 0===e?void 0:e.completeRequest()}));return this._bridge.deliverMessage({method:"connect",params:e}),t}))}disconnect(e){return y(this,void 0,void 0,(function*(){return this.disconnectEvent(!0,e)}))}disconnectEvent(e,t){return y(this,void 0,void 0,(function*(){if(!this._bridge)return;const r=this._bridge,n=this._session,i=r.url;if(this.setAddress(void 0),this._bridge=void 0,this._session=0,e)try{yield r.postMessage({method:"disconnect",params:[t],session:n})}catch(o){console.warn("disconnect request failed")}r.off("message",this._listener),r.off("builtin",this._emitterPassthrough),v._bridges[i].sessions=v._bridges[i].sessions.filter((e=>e!=n)),setTimeout((()=>{v._bridges[i].sessions.length||(v._bridges[i].bridge.destructor(),delete v._bridges[i])}),100)}))}postMessage(e,t,r){return new Promise(((n,i)=>{if(!this._bridge)return i("URL missing");this.once("disconnect",i),this._bridge.postMessage({method:e,params:t,session:this._session,protocol:null===r||void 0===r?void 0:r.protocol,version:null===r||void 0===r?void 0:r.version},r).then(n).catch(i)}))}}v._bridges={};const _=(m=v,class extends m{constructor(...e){super(...e),this.namespaces={arweaveWallet:{walletName:"ArConnect",connect:()=>this.address||this.connect(),disconnect:()=>this.disconnect(),getActiveAddress:()=>this.address,getActivePublicKey:()=>this.getPublicKey(),getAllAddresses:()=>{throw"not implemented"},getWalletNames:()=>{throw"not implemented"},sign:(e,t)=>this.signTransaction(e,t),dispatch:(e,t)=>this.dispatch(e,t),encrypt:()=>{throw"not implemented"},decrypt:(e,t)=>this.decrypt(e,t),getPermissions:()=>["ACCESS_ADDRESS","ACCESS_PUBLIC_KEY","ACCESS_ALL_ADDRESSES","SIGN_TRANSACTION","ENCRYPT","DECRYPT","SIGNATURE","ACCESS_ARWEAVE_CONFIG","DISPATCH"],getArweaveConfig:()=>this.getArweaveConfig()}}}postMessage(e,t,r){return super.postMessage(e,t,Object.assign(Object.assign({},r),{protocol:"arweave",version:"1.0.0"}))}getPublicKey(){return o(this,void 0,void 0,(function*(){const e=yield this.postMessage("getPublicKey");if(!(0,i.is)(e,(e=>function(e){return"string"!==typeof e?{}:null}(e))))throw"TypeError";return e}))}getArweaveConfig(){return o(this,void 0,void 0,(function*(){const e=yield this.postMessage("getArweaveConfig");if(!(0,i.is)(e,(e=>{function t(e){return void 0!==e?{}:null}function r(e){return"string"!==typeof e?{}:null}function n(e){var n=[t,r];for(const t of n)if(!t(e))return null;return{}}function i(e){return"number"!==typeof e?{}:null}function o(e){return!1!==e?{}:null}function s(e){return!0!==e?{}:null}function u(e){if("object"!==typeof e||null===e||Array.isArray(e))return{};if("protocol"in e&&(u=n(e.protocol)))return u;if("host"in e&&(u=n(e.host)))return u;if("port"in e){var u=function(e){var n=[t,r,i];for(const t of n)if(!t(e))return null;return{}}(e.port);if(u)return u}return"timeout"in e&&(u=function(e){var r=[t,i];for(const t of r)if(!t(e))return null;return{}}(e.timeout),u)||"logging"in e&&(u=function(e){var r=[t,o,s];for(const t of r)if(!t(e))return null;return{}}(e.logging),u)?u:null}function a(e){if("object"!==typeof e||null===e||Array.isArray(e))return{};if("logger"in e){var t=(e.logger,null);if(t)return t}return null}return function(e){var t=[u,a];for(const n of t){var r=n(e);if(r)return r}return null}(e)})))throw"TypeError";return delete e.logger,e}))}signTransaction(e,t){var r;return o(this,void 0,void 0,(function*(){const{data:o,chunks:u}=e,a=s(e,["data","chunks"]),f=yield this.postMessage("signTransaction",[a,t]);if(!(0,i.is)(f,(e=>{function t(e){return"string"!==typeof e?{}:null}function r(e){return void 0!==e?{}:null}function n(e){return null!==e?{}:null}function i(e){var i=[r,n,t];for(const t of i)if(!t(e))return null;return{}}function o(e){return"object"!==typeof e||null===e||Array.isArray(e)?{}:"name"in e?(r=t(e.name))?r:"value"in e?(r=t(e.value))?r:null:{}:{};var r}function s(e){if(!Array.isArray(e))return{};for(let r=0;r<e.length;r++){var t=o(e[r]);if(t)return t}return null}return function(e){if("object"!==typeof e||null===e||Array.isArray(e))return{};if(!("id"in e))return{};if(o=t(e.id))return o;if("owner"in e&&(o=i(e.owner)))return o;if("tags"in e){var o=function(e){var t=[r,n,s];for(const r of t)if(!r(e))return null;return{}}(e.tags);if(o)return o}return"signature"in e?(o=t(e.signature))||"reward"in e&&(o=i(e.reward))?o:null:{}}(e)})))throw"TypeError";return e.setSignature({id:f.id,owner:f.owner||e.owner,tags:null===(r=f.tags)||void 0===r?void 0:r.map((e=>new n.Tag(e.name,e.value,!0))),signature:f.signature,reward:f.reward||void 0}),e}))}dispatch(e,t){return o(this,void 0,void 0,(function*(){const r=yield this.postMessage("dispatch",[e,t],{transfer:!0});if(!(0,i.is)(r,(e=>{function t(e){return"BASE"!==e?{}:null}function r(e){return"BUNDLED"!==e?{}:null}return function(e){if("object"!==typeof e||null===e||Array.isArray(e))return{};if("id"in e){var n=function(e){return"string"!==typeof e?{}:null}(e.id);if(n)return n}return"type"in e&&(n=function(e){var n=[t,r];for(const t of n)if(!t(e))return null;return{}}(e.type),n)?n:null}(e)})))throw"TypeError";return r}))}decrypt(e,t){return o(this,void 0,void 0,(function*(){const r=yield this.postMessage("decrypt",[e,t]);if(!ArrayBuffer.isView(r))throw"TypeError";return new(0,e.constructor)(r.buffer)}))}});var m}}]);